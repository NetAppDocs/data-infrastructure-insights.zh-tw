---
sidebar: sidebar 
permalink: task_troubleshooting_linux_acquisition_unit_problems.html 
summary: 採集單元問題的故障排除提示。 
keywords: AU, acquisition unit, trioubleshooting 
---
= Linux 上的擷取單元故障排除
:hardbreaks:
:allow-uri-read: 


[role="lead"]
在這裡您可以找到有關解決 Linux 伺服器上的擷取單元問題的建議。

|===


| *問題：* | *試試這個：* 


| *可觀察性 > 收集器* 頁面上的 *擷取單元* 標籤上的 AU 狀態顯示「憑證已過期」或「憑證已撤銷」。 | 點擊 AU 右側的選單並選擇 *恢復連線*。依照指示恢復您的採集單元：1.停止採集單元 (AU) 服務。您可以按一下「複製停止命令」按鈕快速將命令複製到剪貼簿，然後將該命令貼上到採集單元機器上的命令提示字元中。2.在 AU 上的 _/var/lib/netapp/cloudinsights/acq/conf_ 資料夾中建立一個名為「token」的檔案。3.按一下「複製令牌」按鈕，然後將此令牌貼上到您建立的檔案中。4.重新啟動 AU 服務。按一下「複製重啟命令」按鈕，然後將命令貼到 AU 上的命令提示字元中。 


| 啟動採集單元伺服器服務時權限被拒絕 | 當 AU 安裝在 SELINUX 上時，SE 應設定為 _permissive_ 模式。不支援_Enforcing_模式。將SELINUX設定為寬容模式後，重新啟動AU服務。 


| 未滿足伺服器要求 | 確保您的採集單元伺服器或虛擬機器滿足link:concept_acquisition_unit_requirements.html["要求"] 


| 未滿足網路要求 | 確保您的採集單元伺服器/VM 可以透過連接埠 443 上的 SSL 連線存取您的Data Infrastructure Insights環境 (<environment-name>.c01.cloudinsights.netapp.com)。嘗試以下指令： _ping <environment-name>.c01.cloudinsights.netapp.com_ _traceroute <environment-name>.c01.cloudinsights.netapp.com_ _curl \https://<environment-name>.c01.cloudinsights.netapp. \https://<environment-name>.c01.cloudinsights.netapp.com_ 請注意，需要從 AU 到Data Infrastructure Insights 的「出站」連接埠 443 開放。 


| 代理伺服器配置不正確 | 驗證您的代理設置，並在必要時卸載/重新安裝採集單元軟體以輸入正確的代理設定。1.嘗試“捲曲”。請參閱有關代理的“man curl”資訊/文件：--preproxy，--proxy-*（這是一個通配符“*”，因為 curl 支援許多代理設定）。2.嘗試“wget”。檢查代理選項的文件。 


| 啟動採集服務時，Data Infrastructure Insights中的採集單元安裝失敗，出現憑證錯誤（在 acq.log 中可見）。 | 這可能是由於代理憑證中包含特殊字元造成的。卸載 AU（_sudo cloudinsights-uninstall.sh_）並重新安裝，不要使用特殊字元。 


| Linux：缺少函式庫/未找到文件 | 確保您的 Linux 採集單元伺服器/VM 具有所有必要的程式庫。例如，您必須在伺服器上安裝_unzip_庫。若要安裝 _unzip_ 函式庫，請在執行擷取單元安裝腳本之前執行指令 _*sudo yum install unzip*_ 


| 權限問題 | 確保您以具有_sudo_權限的使用者登入 


| 採集未運行： | 從 /opt/netapp/cloudinsights/acq/logs (Linux) 收集 acq.log 重新啟動擷取服務：sudo cloudinsights-service.sh restart acquisition 


| 資料收集問題： | 點擊「傳送錯誤報告」按鈕，從資料收集器登入頁面發送錯誤報告 


| 狀態：心跳失敗 | 採集單元 (AU) 每 60 秒向Data Infrastructure Insights發送一次心跳以續訂其租約。如果因網路問題或Data Infrastructure Insights無回應而導致心跳呼叫失敗，則 AU 的租用時間不會更新。當 AU 的租賃時間到期時，Data Infrastructure Insights將顯示「心跳失敗」狀態。故障排除步驟：檢查擷取單元伺服器和 CloudInsights 之間的網路連線。檢查採集單元服務是否正在運作。如果服務未運行，請啟動服務。檢查採集單元日誌（/var/log/netapp/cloudinsights/acq/acq.log）以查看是否有任何錯誤。 


| 我看到“心跳錯誤：”訊息 | 如果網路中斷導致擷取單元和Data Infrastructure Insights環境之間的通訊中斷超過一分鐘，則可能會發生此錯誤。驗證 AU 和Data Infrastructure Insights之間的連接是否穩定且活躍。 


| 重新安裝採集單元時，我看到「ValueError：/opt/netapp/cloudinsights(/.*) 的檔案上下文？已定義」。 | 在裝有 SELinux 的系統上，此錯誤訊息可能會出現在 `cloudinsights-uninstall.sh -p`已執行並且要重新安裝採集單元。運行命令 `semanage fcontext -d -t usr_t "/opt/netapp/cloudinsights(/.*)?"`應該糾正問題並刪除該訊息。 
|===


== 關於代理商和防火牆的注意事項

如果您的組織需要使用代理來存取互聯網，您可能需要了解組織的代理行為並尋求某些例外以使Data Infrastructure Insights能夠發揮作用。請記住以下幾點：

* 首先，您的組織是否預設阻止訪問，並且僅允許例外訪問特定網站/網域？如果是這樣，您需要將以下網域新增至例外清單：
+
 *.cloudinsights.netapp.com
+
您的Data Infrastructure Insights採集單元以及您在 Web 瀏覽器中與Data Infrastructure Insights的互動都將轉到具有該網域的主機。

* 其次，一些代理程式嘗試透過使用非NetApp產生的數位憑證冒充Data Infrastructure Insights網站來執行 TLS/SSL 檢查。Data Infrastructure Insights獲取單元的安全模型與這些技術根本不相容。您還需要將上述網域排除在此功能之外，以便Data Infrastructure Insights獲取單元能夠成功登入Data Infrastructure Insights並促進資料發現。


如果設定代理程式進行流量檢查，則必須將Data Infrastructure Insights環境新增至代理設定中的例外清單。此例外清單的格式和設定會根據您的代理環境和工具而有所不同，但通常您必須將Data Infrastructure Insights伺服器的 URL 新增至此例外清單中，以允許 AU 正確與這些伺服器通訊。

最簡單的方法是將Data Infrastructure Insights域本身添加到例外列表中：

 *.cloudinsights.netapp.com
如果沒有設定代理進行流量檢查，則可能需要或不需要例外清單。如果您不確定是否需要將Data Infrastructure Insights新增至例外清單中，或因代理程式和/或防火牆配置而遇到安裝或執行Data Infrastructure Insights的困難，請與您的代理管理團隊聯絡以設定代理程式對 SSL 攔截的處理。



=== 查看代理端點

您可以在入職期間選擇資料收集器時點擊“*代理設定*”鏈接，或點擊“*幫助 > 支援*”頁面上“代理設定”下的連結以查看您的代理端點。將顯示如下表。如果您的環境中有工作負載安全，則設定的端點 URL 也會顯示在此清單中。

image:ProxyEndpoints_NewTable.png["代理端點表"]



== 資源

更多故障排除技巧可在link:https://kb.netapp.com/Cloud/ncds/nds/dii/dii_kbs["NetApp知識庫"]（需要支援登入）。

可以從Data Infrastructure Insights中找到其他支援資訊link:concept_requesting_support.html["支援"]頁。
