---
sidebar: sidebar 
permalink: task_config_telegraf_apache.html 
keywords: telegraf, installation, install, apache 
summary: Apache 資料收集器配置 
---
= Apache 資料收集器
:hardbreaks:
:allow-uri-read: 


[role="lead"]
此資料收集器允許從租戶上的 Apache 伺服器收集資料。

.先決條件
* 您必須設定並正確執行 Apache HTTP 伺服器
* 您必須在代理主機/虛擬機器上擁有 sudo 或管理員權限
* 通常，Apache _mod_status_ 模組會配置為在 Apache 伺服器的「/server-status?auto」位置顯示一個頁面。必須啟用_ExtendedStatus_選項才能收集所有可用欄位。有關如何設定伺服器的信息，請參閱 Apache 模組文件： https://httpd.apache.org/docs/2.4/mod/mod_status.html#enable[]




== 安裝

. 從*可觀察性 > 收集器*中，按一下*+資料收集器*。選擇 Apache。
+
選擇安裝 Telegraf 代理程式的作業系統或平台。

. 如果您尚未安裝用於收集的代理，或者您希望為不同的作業系統或平台安裝代理，請按一下「顯示說明」以展開link:task_config_telegraf_agent.html["代理安裝"]指示。
. 選擇用於此資料收集器的代理存取金鑰。您可以透過點擊 *+ 代理存取金鑰* 按鈕新增新的代理存取金鑰。最佳實務：只有當您想要對資料收集器進行分組（例如按作業系統/平台）時才使用不同的代理存取金鑰。
. 依照設定步驟配置資料收集器。說明根據您用於收集資料的作業系統或平台的類型而有所不同。


image:ApacheDCConfigLinux.png["Apache 設定"]



== 設定

Telegraf 的 Apache HTTP 伺服器外掛程式依賴「mod_status」模組的啟用。啟用此功能後，Apache 的 HTTP 伺服器將公開一個 HTML 端點，您可以在瀏覽器上查看該端點，也可以抓取該端點以提取所有 Apache 的 HTTP 伺服器配置的狀態。



=== 相容性:

配置是針對 Apache 的 HTTP 伺服器版本 2.4.38 開發的。



=== 啟用 mod_status：

啟用和公開“mod_status”模組涉及兩個步驟：

* 啟用模組
* 從模組中公開統計數據




=== 啟用模組：

模組的載入由“/usr/local/apache/conf/httpd.conf”下的設定檔控制。編輯設定檔並取消註解以下行：

 LoadModule status_module modules/mod_status.so
 Include conf/extra/httpd-info.conf


=== 從模組公開統計資料：

'mod_status' 的公開由 '/usr/local/apache2/conf/extra/httpd-info.conf' 下的設定檔控制。確保該設定檔中包含以下內容（至少其他指令也會存在）：

[listing]
----
# Allow server status reports generated by mod_status,
# with the URL of http://servername/server-status
<Location /server-status>
    SetHandler server-status
</Location>

#
# ExtendedStatus controls whether Apache will generate "full" status
# information (ExtendedStatus On) or just basic information (ExtendedStatus
# Off) when the "server-status" handler is called. The default is Off.
#
ExtendedStatus On
----
有關“mod_status”模組的詳細說明，請參閱link:https://httpd.apache.org/docs/2.4/mod/mod_status.html#enable["Apache 文件"]



== 物體和計數器

收集以下物件及其計數器：

[cols="<.<,<.<,<.<,<.<"]
|===
| 目的： | 標識符： | 屬性： | 數據點： 


| 阿帕契 | 命名空間伺服器 | 節點 IP 節點名稱 連接埠 父伺服器設定產生 父伺服器 MPM 產生伺服器正常運作時間正在停止 | 繁忙工作者 每個請求的位元組數 每秒位元組數 CPU 子進程 系統 CPU 子進程 使用者 CPU 負載 CPU 系統 CPU 用戶 非同步連接 關閉非同步連接 保持活動異步連接 寫入連接 每個請求的總持續時間 空閒工作者 平均負載（最近 1 分鐘） 平均負載（最近記 15 分鐘） 持續時間總數 5 分鐘）關閉記分板 DNS 尋找記分板 完成記分板 空閒清理記分板 保持活動記分板 記錄記分板 開啟記分板 讀取記分板 發送記分板 啟動記分板 等待 
|===


== 故障排除

更多資訊可從link:concept_requesting_support.html["支援"]頁。
